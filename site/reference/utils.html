
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="fft.html">
      
      
        <link rel="next" href="se.html">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.11">
    
    
      
        <title>pypty.utils - PyPty (python + ptychography)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="cyan">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyptyutils" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../index.html" title="PyPty (python + ptychography)" class="md-header__button md-logo" aria-label="PyPty (python + ptychography)" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyPty (python + ptychography)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              pypty.utils
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="cyan"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/Anton-Gladyshev/pypty" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../index.html" title="PyPty (python + ptychography)" class="md-nav__button md-logo" aria-label="PyPty (python + ptychography)" data-md-component="logo">
      
  <img src="../logo.png" alt="logo">

    </a>
    PyPty (python + ptychography)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Anton-Gladyshev/pypty" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../experiment.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Description of the experiment
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_breakdown.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples for iterative ptychography
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples_direct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples for direct methods
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../custom_presets.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide for creating custom presets
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../example_full.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Notebook / example pipeline
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="initialize.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.initialize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="dpc.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.dpc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tcbf.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.tcbf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="direct.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.direct
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="iterative.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.iterative
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="objective.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.objective
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="multislice_core.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.multislice_core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="fft.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.fft
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    pypty.utils
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="utils.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    pypty.utils
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pypty.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.fourier_clean_3d" class="md-nav__link">
    <span class="md-ellipsis">
      fourier_clean_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.fourier_clean" class="md-nav__link">
    <span class="md-ellipsis">
      fourier_clean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_spatial_frequencies" class="md-nav__link">
    <span class="md-ellipsis">
      create_spatial_frequencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.shift_probe_fourier" class="md-nav__link">
    <span class="md-ellipsis">
      shift_probe_fourier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.generate_mask_for_grad_from_pos" class="md-nav__link">
    <span class="md-ellipsis">
      generate_mask_for_grad_from_pos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_phase_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_phase_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_phase_abs_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_phase_abs_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_mag_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_mag_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.construct_update_abs_proto_phase" class="md-nav__link">
    <span class="md-ellipsis">
      construct_update_abs_proto_phase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.wolfe_1" class="md-nav__link">
    <span class="md-ellipsis">
      wolfe_1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.wolfe_2" class="md-nav__link">
    <span class="md-ellipsis">
      wolfe_2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.upsample_something_3d" class="md-nav__link">
    <span class="md-ellipsis">
      upsample_something_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.downsample_something_3d" class="md-nav__link">
    <span class="md-ellipsis">
      downsample_something_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.upsample_something" class="md-nav__link">
    <span class="md-ellipsis">
      upsample_something
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.downsample_something" class="md-nav__link">
    <span class="md-ellipsis">
      downsample_something
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.preprocess_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_dataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_window" class="md-nav__link">
    <span class="md-ellipsis">
      get_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_num_to_nmab" class="md-nav__link">
    <span class="md-ellipsis">
      convert_num_to_nmab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.nmab_to_strings" class="md-nav__link">
    <span class="md-ellipsis">
      nmab_to_strings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_derivatives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_gradient_rotation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_gradient_rotation_angle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.apply_defocus_probe" class="md-nav__link">
    <span class="md-ellipsis">
      apply_defocus_probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padfft" class="md-nav__link">
    <span class="md-ellipsis">
      padfft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padprobetodatafarfield" class="md-nav__link">
    <span class="md-ellipsis">
      padprobetodatafarfield
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padprobetodatanearfield" class="md-nav__link">
    <span class="md-ellipsis">
      padprobetodatanearfield
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_updated_arrays" class="md-nav__link">
    <span class="md-ellipsis">
      save_updated_arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_static_background_from_nothing" class="md-nav__link">
    <span class="md-ellipsis">
      create_static_background_from_nothing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_probe_from_nothing" class="md-nav__link">
    <span class="md-ellipsis">
      create_probe_from_nothing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.generate_hermite_modes" class="md-nav__link">
    <span class="md-ellipsis">
      generate_hermite_modes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.apply_probe_modulation" class="md-nav__link">
    <span class="md-ellipsis">
      apply_probe_modulation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.prepare_main_loop_params" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_main_loop_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.prepare_saving_stuff" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_saving_stuff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.print_pypty_header" class="md-nav__link">
    <span class="md-ellipsis">
      print_pypty_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_current_checkpoint_obj_probe" class="md-nav__link">
    <span class="md-ellipsis">
      save_current_checkpoint_obj_probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.print_recon_state" class="md-nav__link">
    <span class="md-ellipsis">
      print_recon_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.try_to_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      try_to_gpu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.try_to_initialize_beam_current" class="md-nav__link">
    <span class="md-ellipsis">
      try_to_initialize_beam_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_value_for_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      get_value_for_epoch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_steps_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      get_steps_epoch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.lambda_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      lambda_to_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.string_to_lambda" class="md-nav__link">
    <span class="md-ellipsis">
      string_to_lambda
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.load_params" class="md-nav__link">
    <span class="md-ellipsis">
      load_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.string_params_to_usefull_params" class="md-nav__link">
    <span class="md-ellipsis">
      string_params_to_usefull_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_params" class="md-nav__link">
    <span class="md-ellipsis">
      save_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.phase_cross_corr_align" class="md-nav__link">
    <span class="md-ellipsis">
      phase_cross_corr_align
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_cupy_memory_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_cupy_memory_usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_compute_batch" class="md-nav__link">
    <span class="md-ellipsis">
      get_compute_batch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.load_nexus_params" class="md-nav__link">
    <span class="md-ellipsis">
      load_nexus_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.delete_dataset_from_params" class="md-nav__link">
    <span class="md-ellipsis">
      delete_dataset_from_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_to_nxs" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_nxs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="se.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.se
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="vaa.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pypty.vaa
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pypty.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.fourier_clean_3d" class="md-nav__link">
    <span class="md-ellipsis">
      fourier_clean_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.fourier_clean" class="md-nav__link">
    <span class="md-ellipsis">
      fourier_clean
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_spatial_frequencies" class="md-nav__link">
    <span class="md-ellipsis">
      create_spatial_frequencies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.shift_probe_fourier" class="md-nav__link">
    <span class="md-ellipsis">
      shift_probe_fourier
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.generate_mask_for_grad_from_pos" class="md-nav__link">
    <span class="md-ellipsis">
      generate_mask_for_grad_from_pos
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_phase_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_phase_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_phase_abs_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_phase_abs_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.complex_grad_to_mag_grad" class="md-nav__link">
    <span class="md-ellipsis">
      complex_grad_to_mag_grad
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.construct_update_abs_proto_phase" class="md-nav__link">
    <span class="md-ellipsis">
      construct_update_abs_proto_phase
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.wolfe_1" class="md-nav__link">
    <span class="md-ellipsis">
      wolfe_1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.wolfe_2" class="md-nav__link">
    <span class="md-ellipsis">
      wolfe_2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.upsample_something_3d" class="md-nav__link">
    <span class="md-ellipsis">
      upsample_something_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.downsample_something_3d" class="md-nav__link">
    <span class="md-ellipsis">
      downsample_something_3d
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.upsample_something" class="md-nav__link">
    <span class="md-ellipsis">
      upsample_something
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.downsample_something" class="md-nav__link">
    <span class="md-ellipsis">
      downsample_something
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.preprocess_dataset" class="md-nav__link">
    <span class="md-ellipsis">
      preprocess_dataset
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_window" class="md-nav__link">
    <span class="md-ellipsis">
      get_window
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_num_to_nmab" class="md-nav__link">
    <span class="md-ellipsis">
      convert_num_to_nmab
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.nmab_to_strings" class="md-nav__link">
    <span class="md-ellipsis">
      nmab_to_strings
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_matrix" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_matrix
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_derivatives
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_ctf_gradient_rotation_angle" class="md-nav__link">
    <span class="md-ellipsis">
      get_ctf_gradient_rotation_angle
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.apply_defocus_probe" class="md-nav__link">
    <span class="md-ellipsis">
      apply_defocus_probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padfft" class="md-nav__link">
    <span class="md-ellipsis">
      padfft
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padprobetodatafarfield" class="md-nav__link">
    <span class="md-ellipsis">
      padprobetodatafarfield
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.padprobetodatanearfield" class="md-nav__link">
    <span class="md-ellipsis">
      padprobetodatanearfield
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_updated_arrays" class="md-nav__link">
    <span class="md-ellipsis">
      save_updated_arrays
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_static_background_from_nothing" class="md-nav__link">
    <span class="md-ellipsis">
      create_static_background_from_nothing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.create_probe_from_nothing" class="md-nav__link">
    <span class="md-ellipsis">
      create_probe_from_nothing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.generate_hermite_modes" class="md-nav__link">
    <span class="md-ellipsis">
      generate_hermite_modes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.apply_probe_modulation" class="md-nav__link">
    <span class="md-ellipsis">
      apply_probe_modulation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.prepare_main_loop_params" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_main_loop_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.prepare_saving_stuff" class="md-nav__link">
    <span class="md-ellipsis">
      prepare_saving_stuff
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.print_pypty_header" class="md-nav__link">
    <span class="md-ellipsis">
      print_pypty_header
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_current_checkpoint_obj_probe" class="md-nav__link">
    <span class="md-ellipsis">
      save_current_checkpoint_obj_probe
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.print_recon_state" class="md-nav__link">
    <span class="md-ellipsis">
      print_recon_state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.try_to_gpu" class="md-nav__link">
    <span class="md-ellipsis">
      try_to_gpu
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.try_to_initialize_beam_current" class="md-nav__link">
    <span class="md-ellipsis">
      try_to_initialize_beam_current
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_value_for_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      get_value_for_epoch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_steps_epoch" class="md-nav__link">
    <span class="md-ellipsis">
      get_steps_epoch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.lambda_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      lambda_to_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_to_string" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_string
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.string_to_lambda" class="md-nav__link">
    <span class="md-ellipsis">
      string_to_lambda
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.load_params" class="md-nav__link">
    <span class="md-ellipsis">
      load_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.string_params_to_usefull_params" class="md-nav__link">
    <span class="md-ellipsis">
      string_params_to_usefull_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.save_params" class="md-nav__link">
    <span class="md-ellipsis">
      save_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.phase_cross_corr_align" class="md-nav__link">
    <span class="md-ellipsis">
      phase_cross_corr_align
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_cupy_memory_usage" class="md-nav__link">
    <span class="md-ellipsis">
      get_cupy_memory_usage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.get_compute_batch" class="md-nav__link">
    <span class="md-ellipsis">
      get_compute_batch
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.load_nexus_params" class="md-nav__link">
    <span class="md-ellipsis">
      load_nexus_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.delete_dataset_from_params" class="md-nav__link">
    <span class="md-ellipsis">
      delete_dataset_from_params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pypty.utils.convert_to_nxs" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_nxs
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="pyptyutils"><code>pypty.utils</code><a class="headerlink" href="#pyptyutils" title="Permanent link">&para;</a></h1>


<div class="doc doc-object doc-module">



<a id="pypty.utils"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="pypty.utils.fourier_clean_3d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fourier_clean_3d</span></code>

<a href="#pypty.utils.fourier_clean_3d" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Apply a 3D Fourier filter to the input array.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input 3D array to be filtered.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Cutoff frequency (default is 0.66).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.66</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predefined mask to apply. If None, a mask is generated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rolloff</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Rolloff parameter for smoothing the mask (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for computations (default is cp.float32).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy.float32">float32</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module (default is cp).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy">numpy</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The filtered array after applying the Fourier filter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.fourier_clean" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">fourier_clean</span></code>

<a href="#pypty.utils.fourier_clean" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Apply a Fourier filter to the input array. Supports 2D or 3D arrays.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input array (2D or 3D) to be filtered.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cutoff</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Cutoff frequency (default is 0.66).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.66</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predefined mask to apply. If None, a mask is generated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rolloff</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Rolloff parameter for smoothing the mask (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for computations (default is cp.float32).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy.float32">float32</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module (default is cp).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy">numpy</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The filtered array after applying the Fourier filter.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.create_spatial_frequencies" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_spatial_frequencies</span></code>

<a href="#pypty.utils.create_spatial_frequencies" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate spatial frequency grids and corresponding masks for multislice simulations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>px</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size in the x-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>py</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size in the y-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the grid.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>damping_cutoff_multislice</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Damping cutoff factor for multislice simulations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smooth_rolloff</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Smoothing rolloff parameter.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for computations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tuple containing:
- q2: 2D array of squared spatial frequencies.
- qx: 2D array of spatial frequencies in x.
- qy: 2D array of spatial frequencies in y.
- exclude_mask: Mask in Fourier space.
- exclude_mask_ishift: Unshifted mask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.shift_probe_fourier" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">shift_probe_fourier</span></code>

<a href="#pypty.utils.shift_probe_fourier" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Shift a probe in Fourier space by applying a phase ramp.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input probe array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shift_px</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shift in pixels (y, x).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>tuple of float</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tuple containing the shifted probe, the phase mask, the Fourier transform of the probe,
and the spatial frequency grids (maskx, masky).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.generate_mask_for_grad_from_pos" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_mask_for_grad_from_pos</span></code>

<a href="#pypty.utils.generate_mask_for_grad_from_pos" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Construct a binary mask from given positions and footprint dimensions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shapex</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Width of the mask.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shapey</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Height of the mask.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions_list</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of (y, x) positions where the mask should be activated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of tuple</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape_footprint_x</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Footprint width.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shape_footprint_y</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Footprint height.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shrink</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shrink factor to adjust the footprint (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The constructed binary mask.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.complex_grad_to_phase_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">complex_grad_to_phase_grad</span></code>

<a href="#pypty.utils.complex_grad_to_phase_grad" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert a Wirtinger derivative to the gradient with respect to the phase.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Wirtinger derivative (dL/dz*).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The complex array (z = |z| exp(i*phase)).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The phase gradient (dL/dp).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.complex_grad_to_phase_abs_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">complex_grad_to_phase_abs_grad</span></code>

<a href="#pypty.utils.complex_grad_to_phase_abs_grad" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the phase gradient and negative amplitude gradient from a complex gradient.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The Wirtinger derivative (dL/dz*).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The complex array (z = exp(-a + i*phase)).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>tuple of array_like</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A tuple containing:
- Phase gradient (dL/dp).
- Negative amplitude gradient (dL/da).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.complex_grad_to_mag_grad" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">complex_grad_to_mag_grad</span></code>

<a href="#pypty.utils.complex_grad_to_mag_grad" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Calculate a magnitude gradient from a complex gradient and separate magnitude and phase arrays.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>grad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The complex gradient.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>abs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The magnitude array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>phase</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The phase array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The magnitude gradient.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.construct_update_abs_proto_phase" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">construct_update_abs_proto_phase</span></code>

<a href="#pypty.utils.construct_update_abs_proto_phase" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute object updates projected along phase gradients.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>object_grad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The gradient of the object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current object array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="array_like">array_like</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="array_like">array_like</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The computed update for the object.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.wolfe_1" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wolfe_1</span></code>

<a href="#pypty.utils.wolfe_1" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check the Armijo condition (Wolfe condition 1) for line search.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current function value.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The function value after the step.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The directional derivative at the current point.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Step size.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wolfe_c1</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Armijo condition constant (default is 0.5).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.5</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="bool">bool</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>True if the condition is satisfied, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.wolfe_2" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">wolfe_2</span></code>

<a href="#pypty.utils.wolfe_2" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Check the curvature condition (Wolfe condition 2) for line search.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>d_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The directional derivative at the current point.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_d_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The directional derivative after the step.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wolfe_c2</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Curvature condition constant (default is 0.9).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0.9</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="bool">bool</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>True if the condition is satisfied, False otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.upsample_something_3d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upsample_something_3d</span></code>

<a href="#pypty.utils.upsample_something_3d" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Upsample a 3D array along the last two axes.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>something</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The 3D array to be upsampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scale</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, scales the upsampled result to conserve total sum (default is True).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module, e.g., numpy or cupy (default is numpy).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy">numpy</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The upsampled 3D array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.downsample_something_3d" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">downsample_something_3d</span></code>

<a href="#pypty.utils.downsample_something_3d" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Downsample a 3D array along the last two axes.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>something</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The 3D array to be downsampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Downsampling factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module, e.g., numpy or cupy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The downsampled 3D array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.upsample_something" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">upsample_something</span></code>

<a href="#pypty.utils.upsample_something" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Upsample a 2D array.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>something</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The 2D array to be upsampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>scale</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, scales the result to conserve total sum (default is True).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module (default is numpy).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy">numpy</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The upsampled array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.downsample_something" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">downsample_something</span></code>

<a href="#pypty.utils.downsample_something" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Downsample a 2D array.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>something</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The 2D array to be downsampled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Downsampling factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module, e.g., numpy or cupy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The downsampled array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.preprocess_dataset" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">preprocess_dataset</span></code>

<a href="#pypty.utils.preprocess_dataset" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Apply preprocessing steps to the dataset including shifting, binning, padding, and scaling.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_one_by_one</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether data is loaded incrementally.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Type of reconstruction algorithm.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recon_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Type of reconstruction (e.g., near_field, far_field).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_shift_vector</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Vector indicating pixel shift in y and x.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_bin</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Binning factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding size.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor for the pattern.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_multiplier</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Factor to scale data intensity.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module, e.g., numpy or cupy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>force_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, apply forced padding.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Tuple containing:
- preprocessed dataset
- data_shift_vector
- data_bin
- data_pad
- data_multiplier</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_window" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_window</span></code>

<a href="#pypty.utils.get_window" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a circular cosine-tapered window mask.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the square window.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>r0</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Inner radius where tapering begins (normalized).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>r_max</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Outer radius where mask falls to zero (normalized).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>inverted</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, returns 1 - mask (default is True).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A 2D mask array of the specified shape.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.convert_num_to_nmab" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_num_to_nmab</span></code>

<a href="#pypty.utils.convert_num_to_nmab" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert a number of aberration terms to (n, m, ab) indices based on Krivanek notation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>num_abs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>tuple of lists</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Lists of n, m, and ab strings ('', 'a', or 'b') for each aberration mode.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.nmab_to_strings" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nmab_to_strings</span></code>

<a href="#pypty.utils.nmab_to_strings" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert aberration indices into string identifiers in Krivanek notation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>possible_n</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of radial indices.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>possible_m</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of azimuthal indices.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of int</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>possible_ab</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of aberration mode types ('', 'a', 'b').</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list of str</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>list of str</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>List of formatted aberration identifiers like 'C30a', 'C11', etc.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_ctf_matrix" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ctf_matrix</span></code>

<a href="#pypty.utils.get_ctf_matrix" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate a matrix of phase contributions for all aberration modes.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>kx</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in x-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ky</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in y-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_abs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wavelength</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Electron wavelength.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array module (default is cupy).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy">numpy</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>list of Zernike polynomials (num_abs, height, width) with phase contributions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_ctf" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ctf</span></code>

<a href="#pypty.utils.get_ctf" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the scalar contrast transfer function (CTF) from aberrations.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>aberrations</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or <span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kx</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in x-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ky</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in y-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wavelength</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Electron wavelength.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle_offset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional rotation angle in radians (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The computed CTF.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_ctf_derivatives" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ctf_derivatives</span></code>

<a href="#pypty.utils.get_ctf_derivatives" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute spatial derivatives of the CTF with respect to kx and ky.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>aberrations</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or <span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kx</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in x-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ky</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in y-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wavelength</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Electron wavelength.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle_offset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional rotation angle (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>tuple of ndarray</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Derivatives of CTF with respect to kx and ky.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_ctf_gradient_rotation_angle" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_ctf_gradient_rotation_angle</span></code>

<a href="#pypty.utils.get_ctf_gradient_rotation_angle" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute the gradient of the phase with respect to rotation angle.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>aberrations</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or <span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kx</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in x-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>ky</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spatial frequency in y-direction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>wavelength</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Electron wavelength.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>angle_offset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Additional angular offset (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>tuple of ndarray</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Derivatives of the CTF gradient in x and y directions with respect to angular change.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.apply_defocus_probe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_defocus_probe</span></code>

<a href="#pypty.utils.apply_defocus_probe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Apply a defocus phase shift to a probe in Fourier space.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input probe wavefunction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>distance</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Defocus distance in meters.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc_voltage</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Acceleration voltage in kiloelectronvolts (keV).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pixel_size_x_A</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size along x in angstroms.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pixel_size_y_A</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size along y in angstroms.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex data type for computation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float data type for computation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Numerical backend (NumPy or CuPy).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The defocused probe.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.padfft" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">padfft</span></code>

<a href="#pypty.utils.padfft" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pad the input array in Fourier space by padding its FFT.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input array to be padded.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of pixels to pad on each side.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The padded array in spatial domain.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.padprobetodatafarfield" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">padprobetodatafarfield</span></code>

<a href="#pypty.utils.padprobetodatafarfield" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pad or crop a probe in Fourier space to match far-field data dimensions.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The probe wavefunction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the measured data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding applied to the data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor used in the reconstruction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Adjusted probe wavefunction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.padprobetodatanearfield" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">padprobetodatanearfield</span></code>

<a href="#pypty.utils.padprobetodatanearfield" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Pad or crop a probe for near-field reconstruction.</p>
<p>This function adjusts the probe wavefunction by padding or cropping it to match the
near-field measured data dimensions after upsampling and padding.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The input probe wavefunction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the measured data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding size applied to the data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor applied to the measured data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The adjusted probe wavefunction.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.save_updated_arrays" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_updated_arrays</span></code>

<a href="#pypty.utils.save_updated_arrays" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save current reconstruction state and log loss metrics during training.</p>
<p>This function saves checkpoints for object, probe, tilts, scan positions, static background, 
aberration coefficients, and beam current if specified. It also logs loss and constraint 
contributions in a CSV file if logging is enabled.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory where files will be saved.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current epoch number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save the current probe.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_pos_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save current scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_tilts_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save current tilts.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_obj_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save the current object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Object array to save.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or <span title="xp.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Probe array to save.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or <span title="xp.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tilt correction values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_pos_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sub-pixel scan position correction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Original tilt values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>static_background</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Static background array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or <span title="xp.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_aberrations_array_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save aberration array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_static_background_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save static background.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>count</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Not used inside the function.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_loss</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current loss value.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_sse</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current sum of squared errors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aberrations</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or <span title="xp.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beam_current</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of beam current values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or <span title="xp.ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_beam_current_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save beam current.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to trigger checkpoint saving.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_loss_log</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to log loss. If set to 2, log full breakdown of constraints.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span> or <span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constraint_contributions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of constraint term contributions to the loss.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>actual_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Step size applied in the optimizer.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>count_linesearch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of line search iterations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>d_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial directional derivative.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>new_d_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>New directional derivative after the step.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_update_step_bfgs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Step size suggested by BFGS or optimizer.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Start time of the epoch (used for timing).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>NumPy or CuPy module used for computation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>warnings</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Warning string to be logged.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.create_static_background_from_nothing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_static_background_from_nothing</span></code>

<a href="#pypty.utils.create_static_background_from_nothing" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate an initial static background if none is provided.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>static_background</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial static background value or None.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span> or <span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Probe wavefunction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>damping_cutoff_multislice</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Maximum spatial frequency used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding to be applied.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type for output.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recon_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Type of reconstruction ('near_field' or 'far_field').</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Initialized static background.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.create_probe_from_nothing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_probe_from_nothing</span></code>

<a href="#pypty.utils.create_probe_from_nothing" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate an initial probe guess when no valid probe is provided.</p>
<p>Depending on the input, this function either uses an aperture mask, computes a mean pattern
from the dataset, or adjusts an existing mean pattern to generate a probe. It applies shifting,
binning, padding, and scaling to produce a probe suitable for the specified reconstruction type.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Input probe. If set to "aperture", the aperture mask is used. If None, the probe is generated
based on the mean pattern.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>ndarray, str, or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding size applied to the data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>mean_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Mean pattern used to generate the probe if no probe is provided.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aperture_mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Aperture mask used when probe is set to "aperture".</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilt_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating if tilt mode is active.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tilt values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Measured dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>estimate_aperture_based_on_binary</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Factor used to threshold the dataset for aperture estimation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span> or <span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pixel_size_x_A</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size in the x-direction in angstroms.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc_voltage</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Acceleration voltage in keV.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_multiplier</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Factor to scale the data intensity.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>masks</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional masks to apply to the mean pattern.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_shift_vector</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Vector indicating the shift to be applied to the data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>list or tuple of int</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_bin</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Binning factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample_pattern</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor applied to the pattern.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex_cpu</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex data type for CPU computations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag controlling verbosity.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Identifier for the reconstruction algorithm.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the measured data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_obj_modes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of object modes.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe_marker</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Marker array for probe scenarios.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>recon_type</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Type of reconstruction ("near_field" or "far_field").</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>defocus_array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of defocus values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>Cs</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Spherical aberration coefficient.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The generated probe as a complex array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.generate_hermite_modes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">generate_hermite_modes</span></code>

<a href="#pypty.utils.generate_hermite_modes" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Generate Hermite polynomial-based probe modes from a main mode.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>main_mode</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The main probe mode.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_herm_x</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Max Degree of Hermite polynomials in x.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_herm_y</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Max Degree of Hermite polynomials in y.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex data type to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Numerical backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Stack of Hermite-based probe modes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.apply_probe_modulation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">apply_probe_modulation</span></code>

<a href="#pypty.utils.apply_probe_modulation" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Apply defocus, aberrations, Hermite mode generation, and other modulations to the probe.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial probe.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_probe_defocus</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Defocus distance to apply.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc_voltage</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Accelerating voltage in keV.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pixel_size_x_A</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size in x ().</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>pixel_size_y_A</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Pixel size in y ().</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aberrations</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or <span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to print info.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beam_ctf</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional beam CTF to apply.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>n_hermite_probe_modes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Number of Hermite modes in (y, x).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>defocus_spread_modes</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Defocus values to generate additional modes.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe_marker</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Probe assignment array for multi-scenario.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex type.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float type.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Numerical backend.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Modulated probe array.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.prepare_main_loop_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_main_loop_params</span></code>

<a href="#pypty.utils.prepare_main_loop_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Prepare main loop parameters for reconstruction.</p>
<p>This function adjusts scan positions, pads the object if necessary, handles subpixel corrections,
and computes the electron wavelength based on the accelerating voltage.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Identifier for the reconstruction algorithm.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="any">any</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The probe array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The object array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of tilt angles.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the measured data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>acc_voltage</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Accelerating voltage in keV.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>allow_subPixel_shift</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, compute subpixel corrections (default is True).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sequence</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sequence of indices for positions (default is None, which uses full range).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span> or <span title="callable">callable</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>use_full_FOV</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, use full field-of-view adjustments (default is False).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>False</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Verbosity flag (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float_cpu</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float data type for CPU computations (default is np.float64).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy.float64">float64</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex_cpu</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex data type for CPU computations (default is np.complex128).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy.complex128">complex128</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_int_cpu</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer data type for CPU computations (default is np.int64).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="data">data</span> - <span title="type">type</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code><span title="numpy.int64">int64</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe_constraint_mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional mask for probe constraints.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aperture_mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional aperture mask.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>extra_space_on_side_px</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Extra padding (in pixels) to add to scan positions (default is 0).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>0</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>A tuple containing:
- obj : ndarray
    The padded object array.
- positions : ndarray
    Adjusted (rounded) scan positions.
- int
    A placeholder zero (reserved for future use).
- sequence : list
    The sequence of indices used.
- wavelength : float
    Computed electron wavelength in angstroms.
- full_pos_correction : ndarray
    Subpixel corrections for scan positions.
- tilts_correction : ndarray
    Array of zeros with same shape as tilts (tilt corrections).
- aperture_mask : ndarray or None
    The probe constraint mask or aperture mask if provided.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.prepare_saving_stuff" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">prepare_saving_stuff</span></code>

<a href="#pypty.utils.prepare_saving_stuff" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Prepare folder and loss CSV for saving training logs.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory for results.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_loss_log</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to save loss values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch_prev</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Previous epoch index.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.print_pypty_header" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_pypty_header</span></code>

<a href="#pypty.utils.print_pypty_header" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print formatted header announcing start of reconstruction.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory where results are saved.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>save_loss_log</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether loss logging is enabled.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.save_current_checkpoint_obj_probe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_current_checkpoint_obj_probe</span></code>

<a href="#pypty.utils.save_current_checkpoint_obj_probe" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save intermediate reconstruction data as checkpoints.</p>
<p>This function saves the current state of the object, probe, tilt corrections, scan positions,
static background, and aberrations to disk. It is intended to allow resuming reconstruction
from the last checkpoint.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>output_folder</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory where checkpoint files will be saved.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current object array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>ndarray or GPU array</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current probe array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>ndarray or GPU array</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Correction values for tilt angles.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_pos_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sub-pixel correction values for scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Scan positions array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tilt angles array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>static_background</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Static background array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the probe.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_obj_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the object.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_pos_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_tilts_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the tilt angles.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_static_background_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the static background.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_aberrations_array_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the aberrations array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aberrations_array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current aberrations array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>ndarray or GPU array</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beam_current</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>The current beam current array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code>ndarray or GPU array or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>bcstep</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Flag indicating whether to save the beam current.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Numerical backend (e.g., numpy or cupy).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.print_recon_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">print_recon_state</span></code>

<a href="#pypty.utils.print_recon_state" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Display current reconstruction progress including loss, optimization state, and updates.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>t0</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Start time of the epoch (Unix timestamp).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>algorithm</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Name of the loss or optimization algorithm used.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current training epoch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_loss</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Loss value at current epoch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_sse</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sum of squared errors.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_obj_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether the object is being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether the probe is being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_probe_pos_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether the scan grid is being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_tilts_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether tilt corrections are being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_static_background_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether static background is being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_aberrations_array_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether aberration coefficients are being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_beam_current_step</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether beam current is being updated.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>current_hist_length</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optimizer memory length (0=GD, 1=CG, &gt;1=BFGS).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Verbosity flag: 0 = silent, 1 = single-line print, 2 = verbose.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.try_to_gpu" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">try_to_gpu</span></code>

<a href="#pypty.utils.try_to_gpu" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert all key reconstruction variables to GPU arrays if using CuPy.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Object array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Probe array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>positions</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer scan positions.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>full_pos_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Sub-pixel scan grid correction.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tilt values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tilts_correction</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Tilt corrections.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>masks</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Optional segmentation or region masks.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>defocus_array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of defocus values per position.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>slice_distances</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Slice spacing in multislice simulations.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aperture_mask</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Probe aperture mask.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dataset</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Measured dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_one_by_one</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether dataset is streamed from disk.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>static_background</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Static background array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>aberrations_array</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Array of aberration coefficients.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>beam_current</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Beam current scaling factor.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float precision dtype for casting.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_complex</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Complex precision dtype for casting.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_int</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Integer dtype for casting.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Numerical backend (<code>numpy</code> or <code>cupy</code>).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The same variables in GPU format (if using CuPy), with proper types.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.try_to_initialize_beam_current" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">try_to_initialize_beam_current</span></code>

<a href="#pypty.utils.try_to_initialize_beam_current" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Initialize beam current array or pad if it's too short.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>beam_current</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Existing beam current values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span> or None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of measured dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float type for the array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>xp</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>NumPy or CuPy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="module">module</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Initialized or padded beam current.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_value_for_epoch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_value_for_epoch</span></code>

<a href="#pypty.utils.get_value_for_epoch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluate a list of values or functions at the current epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>func_or_value</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of fixed values or callables.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current epoch number.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float precision type.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Evaluated values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_steps_epoch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_steps_epoch</span></code>

<a href="#pypty.utils.get_steps_epoch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Evaluate step values for the current epoch.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>steps</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>List of (multiplier, callable) or fixed values.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="list">list</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>epoch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Current training epoch.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_float</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Float precision type.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dtype">dtype</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="list">list</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>List of step values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.lambda_to_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lambda_to_string</span></code>

<a href="#pypty.utils.lambda_to_string" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Extract lambda function source as a string.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>f</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Lambda function.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="function">function</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="str">str</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Extracted string source of the lambda.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.convert_to_string" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_string</span></code>

<a href="#pypty.utils.convert_to_string" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert parameter dictionary to string format, including lambda serialization.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>dicti2</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Original parameter dictionary.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strip_dataset_from_params</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether to exclude 'dataset' key (default is True).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>True</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary with string values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.string_to_lambda" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">string_to_lambda</span></code>

<a href="#pypty.utils.string_to_lambda" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert stringified lambda expression to a Python function.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lambda_string</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Lambda string to evaluate.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="callable">callable</span> or <span title="str">str</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>The resulting function or original string if evaluation fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.load_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_params</span></code>

<a href="#pypty.utils.load_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load parameter dictionary from a .pkl file.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the .pkl parameter file.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Loaded parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.string_params_to_usefull_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">string_params_to_usefull_params</span></code>

<a href="#pypty.utils.string_params_to_usefull_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert string-encoded lambdas in parameter dictionary back to callables.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Parameter dictionary possibly containing lambda strings.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Updated dictionary with callables.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.save_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save_params</span></code>

<a href="#pypty.utils.save_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Save parameters to a .pkl file, optionally removing the dataset.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Output path for the parameter file.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>params</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Parameter dictionary to save.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="dict">dict</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>strip_dataset_from_params</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>If True, remove the dataset entry.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.phase_cross_corr_align" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">phase_cross_corr_align</span></code>

<a href="#pypty.utils.phase_cross_corr_align" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Align two FFT-transformed images using phase cross-correlation.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>im_ref_fft</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Reference image FFT.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>im_2_fft</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>FFT of the image to be aligned.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>refine_box_dim</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Size of the interpolation box for sub-pixel alignment.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>upsample</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Upsampling factor for interpolation.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>x_real</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Real space x grid.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>y_real</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Real space y grid.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="ndarray">ndarray</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shift_y</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predefined shift in y (optional).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>shift_x</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Predefined shift in x (optional).</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span> or None</code>
                  </span>
                  <span class="doc-param-default">
                    <b>DEFAULT:</b>
                      <code>None</code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="ndarray">ndarray</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Shifted FFT of the second image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_cupy_memory_usage" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_cupy_memory_usage</span></code>

<a href="#pypty.utils.get_cupy_memory_usage" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Print current CuPy GPU memory usage statistics.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.get_compute_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_compute_batch</span></code>

<a href="#pypty.utils.get_compute_batch" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate the optimal compute batch size based on GPU memory usage.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>compute_batch</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Initial guess or default.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>load_one_by_one</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Whether data is streamed instead of fully loaded.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>hist_size</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>History size for optimizers.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>measured_data_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the input dataset.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>memory_saturation</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Proportion of GPU memory to use.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="float">float</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>smart_memory</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>User-provided memory strategy.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="callable">callable</span> or <span title="bool">bool</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data_pad</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Padding applied to data.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>obj_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the object array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>probe_shape</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Shape of the probe array.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="tuple">tuple</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>dtype</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Data type string ('single' or 'double').</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>propmethod</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Propagation method name.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>print_flag</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Verbosity.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="int">int</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="tuple">tuple</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Suggested batch size, load_one_by_one flag, and memory strategy.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.load_nexus_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_nexus_params</span></code>

<a href="#pypty.utils.load_nexus_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Load reconstruction parameters from a NeXus (.nxs) HDF5 file.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>path_nexus</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the .nxs file.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code><span title="dict">dict</span></code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                <p>Dictionary of extracted parameters.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.delete_dataset_from_params" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">delete_dataset_from_params</span></code>

<a href="#pypty.utils.delete_dataset_from_params" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Delete the 'dataset' key from saved parameter file.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>params_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path to the pickled parameters file.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="pypty.utils.convert_to_nxs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_nxs</span></code>

<a href="#pypty.utils.convert_to_nxs" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert saved PyPty reconstruction data to NeXus (.nxs) format.</p>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">PARAMETER</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>folder_path</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Directory containing saved reconstruction files.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_file</code>
            </td>
            <td class="doc-param-details">
              <div class="doc-md-description">
                <p>Path where the NeXus file will be saved.</p>
              </div>
              <p>
                  <span class="doc-param-annotation">
                    <b>TYPE:</b>
                      <code><span title="str">str</span></code>
                  </span>
              </p>
            </td>
          </tr>
      </tbody>
    </table>


<table>
      <thead>
        <tr>
          <th><span class="doc-section-title">RETURNS</span></th>
          <th><span>DESCRIPTION</span></th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <span class="doc-returns-annotation">
                    <code>None</code>
                </span>
            </td>
            <td class="doc-returns-details">
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.sections", "content.code.annotate", "content.tabs.link"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
  </body>
</html>